Use Node.js for backend and React.js for frontend and PostgreSQL for database. Do not use TypeScript no file with .ts ending:

We have a University voting system that will be implemented with combination of web3 and web2. Inititally we are starting with the registration and login pages for now, then we will continue the rest, for now after login blank page can be shown until we developed the rest. 


Implementation of Registration and Login Pages

For our project, we now need to implement the registration and login functionality to facilitate user authentication. There are two types of users in the system:

    Students (who need to register before they can log in)
    Admins (who will have pre-registered credentials and only need to log in)


Admin Login (No Registration Required)

Admins will not have to go through a registration process. Instead, their credentials (such as email and password) will already be stored in the database beforehand. Admins will simply log in using their predefined credentials.

To implement this:

    We will introduce a login page for admins where they enter their credentials.
    The system will verify the provided credentials by checking them against the database.
    If the credentials match, the admin will be granted access to their dashboard.
    If they do not match, the system will return an authentication error.

Student Registration Process

Since this system is designed for ADA University students, we need to ensure that only valid students can register. To achieve this, we will enforce a strict email verification process as follows, students must also provide their Faculty from drop down menu during registration process.

    University Email Requirement
        Students must use their ADA University email address, which must end with â€œ@ada.edu.azâ€.
        The system will validate the email format and reject any non-ADA email addresses during registration.
        One email address can only registered once.

    Email Verification via OTP (One-Time Password)
        After the student submits their email and password during registration, the system will generate a 6-digit OTP (One-Time Password).
        The OTP will be sent to the studentâ€™s university email address using NodeMailer (a Node.js library for sending emails).
        A dedicated email account has already been created for sending these OTP messages.

    Pending Users Table for OTP Management
        To ensure security and prevent unauthorized access, OTPs should have an expiration time.
        We will create a "Pending Users" table in the database, where each OTP along with the studentâ€™s email will be temporarily stored.
        If the OTP is not entered within the expiration time (e.g., 3 minutes), it will be automatically deleted from the pending users table, and the student will need to request a new OTP.

    Finalizing Student Registration
        Once the student enters the correct OTP within the valid time frame, their registration is confirmed.
        The system will then move their credentials from the pending users table to the actual voters table, making them a registered voter in the system.

Login Process for Students

After successful registration, students will be able to log in using their university email and password. The process involves:

    Email and Password Verification
        The system will check if the entered email and password match an entry in the voters table.

    Successful Login
        If the credentials are correct, the student will be granted access to the system.

    Failed Login Attempts
        If incorrect credentials are entered, the system will return an error message.
        For security reasons, we can implement account lockout mechanisms after multiple failed attempts.

1. Password Security

ğŸ”¹ Hash and Salt Passwords

    Store passwords in a hashed and salted format using bcrypt (or another secure hashing algorithm).
    Never store plaintext passwords in the database.

ğŸ”¹ Enforce Strong Password Policies

    Require passwords to be at least 8-12 characters long.
    Include uppercase letters, lowercase letters, numbers, and special characters.

ğŸ”¹ Prevent Credential Stuffing

    Block repeated login attempts after multiple failed attempts (e.g., 5 tries).
    Introduce a cooldown period before retrying.

2. OTP Security for Student Registration

ğŸ”¹ Use Randomly Generated OTPs

    Generate a secure random 4-digit OTP (avoid predictable patterns).

ğŸ”¹ Set an Expiration Time

    OTPs should expire after 5-10 minutes.
    Expired OTPs should be automatically removed from the database.

ğŸ”¹ Limit OTP Requests

    Prevent users from requesting multiple OTPs in a short time to avoid spamming the system.
    Introduce a delay (e.g., 30 seconds to 1 minute) before allowing another OTP request.

3. Secure Database Practices

ğŸ”¹ Use Parameterized Queries

    Always use prepared statements or ORM methods to prevent SQL injection.

ğŸ”¹ Restrict Admin Privileges

    Ensure that students cannot access admin pages by mistake.
    Separate user roles in the database to avoid privilege escalation attacks.

ğŸ”¹ Encrypt Sensitive Data

    Besides hashing passwords, consider encrypting other sensitive user information (if applicable).

4. Session and Authentication Security

ğŸ”¹ Use Secure Sessions

    Implement session tokens to manage authenticated users instead of storing login credentials in local storage.

ğŸ”¹ Logout Expiry

    Implement automatic logout after inactivity (e.g., 15-30 minutes).

ğŸ”¹ Prevent Session Hijacking

    Store authentication tokens securely and ensure session identifiers are random and non-guessable.

5. Input Validation and Data Sanitization

ğŸ”¹ Validate User Inputs

    Ensure that email fields only accept valid ADA University emails (@ada.edu.az).
    Reject any special characters in fields where they are not needed.

ğŸ”¹ Sanitize Inputs to Prevent XSS (Cross-Site Scripting)

    Strip out any potentially harmful JavaScript from user inputs (e.g., <script> tags).

6. Error Handling Best Practices

ğŸ”¹ Avoid Detailed Error Messages

    Do not reveal whether the email or password was incorrect in login failure messages. Instead, use a generic response:
    âœ… "Invalid login credentials" (instead of "Incorrect password" or "User does not exist")

ğŸ”¹ Log Errors Securely

    Maintain logs of login attempts and errors but do not expose them to users.

7. Rate Limiting and Bot Protection

ğŸ”¹ Rate Limit Login and Registration Requests

    Implement a limit on login and OTP verification attempts to prevent brute-force attacks.
